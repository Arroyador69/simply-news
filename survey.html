<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personalize Your Experience - Simply News</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
        }

        .back-link {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        /* Survey Section */
        .survey {
            padding: 120px 0 80px;
            background: white;
            min-height: 100vh;
        }

        .survey-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .survey-title {
            font-size: 2.5rem;
            color: #333;
            margin-bottom: 1rem;
        }

        .survey-subtitle {
            font-size: 1.2rem;
            color: #666;
            max-width: 700px;
            margin: 0 auto;
        }

        .survey-form {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 2rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }

        .checkbox-item:hover {
            background-color: #e9ecef;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
            transform: scale(1.2);
        }

        /* Search functionality */
        .search-container {
            margin-top: 1rem;
            display: none;
        }

        .search-container.active {
            display: block;
        }

        .search-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
            margin-bottom: 1rem;
        }

        .search-results {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            background: white;
        }

        .search-result-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.3s ease;
        }

        .search-result-item:hover {
            background-color: #f8f9fa;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        /* Selected sources display */
        .selected-sources {
            margin-top: 1rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            display: none;
        }

        .selected-sources.show {
            display: block;
        }

        .selected-sources h4 {
            margin: 0 0 0.5rem 0;
            color: #495057;
            font-size: 1rem;
        }

        .selected-sources-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .selected-source-tag {
            background: #667eea;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .remove-source {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 1rem;
            padding: 0;
            opacity: 0.8;
        }

        .remove-source:hover {
            opacity: 1;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 1rem;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .success-message {
            text-align: center;
            padding: 3rem;
            background: #d4edda;
            border-radius: 15px;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .success-message h3 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #155724;
        }

        .success-message p {
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }

        .cta-button {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 15px 30px;
            text-decoration: none;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .survey-title {
                font-size: 2rem;
            }
            
            .survey-subtitle {
                font-size: 1rem;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr;
            }
            
            .survey-form {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <nav class="container">
            <div class="logo">Simply News</div>
            <a href="index.html" class="back-link">‚Üê Back to Home</a>
        </nav>
    </header>

    <!-- Survey Section -->
    <section class="survey">
        <div class="container">
            <div class="survey-header">
                <h1 class="survey-title">Personalize Your Experience</h1>
                <p class="survey-subtitle">Help us send you the news that interests you most. With this information, we can create a personalized news flow tailored to your preferences.</p>
            </div>
            
            <form id="preferencesForm" class="survey-form">
                <div class="form-group">
                    <label for="name">Full Name: *</label>
                    <input type="text" id="name" name="name" required>
                </div>
                
                <div class="form-group">
                    <label for="email">Email: *</label>
                    <input type="email" id="email" name="email" required>
                </div>
                
                <div class="form-group">
                    <label for="telegram">Telegram Username (optional):</label>
                    <input type="text" id="telegram" name="telegram" placeholder="@your_username">
                </div>
                
                <div class="form-group">
                    <label>What topics interest you most? (select all that apply): *</label>
                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" name="interests" value="business">
                            Business
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="interests" value="entertainment">
                            Entertainment
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="interests" value="general">
                            General News
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="interests" value="health">
                            Health
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="interests" value="science">
                            Science
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="interests" value="sports">
                            Sports
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="interests" value="technology">
                            Technology
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="interests" value="cybersecurity">
                            Cybersecurity
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="interests" value="geopolitics">
                            Geopolitics
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="interests" value="ai">
                            Artificial Intelligence
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="interests" value="other" id="otherCheckbox">
                            Other
                        </label>
                    </div>
                    
                    <!-- Search container for "Other" option -->
                    <div id="searchContainer" class="search-container">
                        <input type="text" id="searchInput" class="search-input" placeholder="Choose another topic...">
                        <div id="searchResults" class="search-results" style="display: none;"></div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="country_interest">Country of interest: *</label>
                    <select id="country_interest" name="country_interest" required>
                        <option value="">Select your country</option>
                        <option value="ar">üá¶üá∑ Argentina</option>
                        <option value="au">üá¶üá∫ Australia</option>
                        <option value="at">üá¶üáπ Austria</option>
                        <option value="be">üáßüá™ Belgium</option>
                        <option value="br">üáßüá∑ Brazil</option>
                        <option value="bg">üáßüá¨ Bulgaria</option>
                        <option value="ca">üá®üá¶ Canada</option>
                        <option value="cn">üá®üá≥ China</option>
                        <option value="co">üá®üá¥ Colombia</option>
                        <option value="cu">üá®üá∫ Cuba</option>
                        <option value="cz">üá®üáø Czech Republic</option>
                        <option value="eg">üá™üá¨ Egypt</option>
                        <option value="fr">üá´üá∑ France</option>
                        <option value="de">üá©üá™ Germany</option>
                        <option value="gr">üá¨üá∑ Greece</option>
                        <option value="hk">üá≠üá∞ Hong Kong</option>
                        <option value="hu">üá≠üá∫ Hungary</option>
                        <option value="in">üáÆüá≥ India</option>
                        <option value="id">üáÆüá© Indonesia</option>
                        <option value="ie">üáÆüá™ Ireland</option>
                        <option value="il">üáÆüá± Israel</option>
                        <option value="it">üáÆüáπ Italy</option>
                        <option value="jp">üáØüáµ Japan</option>
                        <option value="lv">üá±üáª Latvia</option>
                        <option value="lt">üá±üáπ Lithuania</option>
                        <option value="my">üá≤üáæ Malaysia</option>
                        <option value="mx">üá≤üáΩ Mexico</option>
                        <option value="ma">üá≤üá¶ Morocco</option>
                        <option value="nl">üá≥üá± Netherlands</option>
                        <option value="nz">üá≥üáø New Zealand</option>
                        <option value="ng">üá≥üá¨ Nigeria</option>
                        <option value="no">üá≥üá¥ Norway</option>
                        <option value="ph">üáµüá≠ Philippines</option>
                        <option value="pl">üáµüá± Poland</option>
                        <option value="pt">üáµüáπ Portugal</option>
                        <option value="ro">üá∑üá¥ Romania</option>
                        <option value="ru">üá∑üá∫ Russia</option>
                        <option value="sa">üá∏üá¶ Saudi Arabia</option>
                        <option value="rs">üá∑üá∏ Serbia</option>
                        <option value="sg">üá∏üá¨ Singapore</option>
                        <option value="sk">üá∏üá∞ Slovakia</option>
                        <option value="si">üá∏üáÆ Slovenia</option>
                        <option value="za">üáøüá¶ South Africa</option>
                        <option value="kr">üá∞üá∑ South Korea</option>
                        <option value="se">üá∏üá™ Sweden</option>
                        <option value="ch">üá®üá≠ Switzerland</option>
                        <option value="tw">üáπüáº Taiwan</option>
                        <option value="th">üáπüá≠ Thailand</option>
                        <option value="tr">üáπüá∑ Turkey</option>
                        <option value="ua">üá∫üá¶ Ukraine</option>
                        <option value="ae">üá¶üá™ United Arab Emirates</option>
                        <option value="gb">üá¨üáß United Kingdom</option>
                        <option value="us">üá∫üá∏ United States</option>
                        <option value="ve">üáªüá™ Venezuela</option>
                    </select>
                </div>
                <!-- Idioma dropdown (solo si el pa√≠s tiene m√°s de un idioma en NewsAPI) -->
                <div class="form-group" id="language-group" style="display:none;">
                    <label for="language_interest">Language: *</label>
                    <select id="language_interest" name="language_interest" required>
                        <!-- Opciones din√°micas -->
                    </select>
                </div>
                <!-- Sources dropdown/list -->
                <div class="form-group" id="sources-group" style="display:none;">
                    <label for="sources">Preferred news sources (select all that apply):</label>
                    <div class="checkbox-group" id="sources-checkboxes">
                        <!-- Las fuentes se llenar√°n din√°micamente seg√∫n el pa√≠s/idioma -->
                    </div>
                    
                    <!-- Selected sources display -->
                    <div class="selected-sources" id="selected-sources">
                        <h4>Your Selected Sources:</h4>
                        <div class="selected-sources-list" id="selected-sources-list">
                            <!-- Las fuentes seleccionadas aparecer√°n aqu√≠ -->
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="frequency">How often would you like to receive news? *</label>
                    <select id="frequency" name="frequency" required>
                        <option value="">Select an option</option>
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="important">Only important news</option>
                        <option value="custom">Custom</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="country_timezone">Country and time zone: *</label>
                    <select id="country_timezone" name="country_timezone" required>
                        <option value="">Select your country and time zone</option>
                        <option value="üá¶üá´ Afghanistan|Asia/Kabul">üá¶üá´ Afghanistan (UTC+4:30)</option>
                        <option value="üá¶üá± Albania|Europe/Tirane">üá¶üá± Albania (UTC+1)</option>
                        <option value="üá©üáø Algeria|Africa/Algiers">üá©üáø Algeria (UTC+1)</option>
                        <option value="üá¶üá∏ American Samoa|Pacific/Pago_Pago">üá¶üá∏ American Samoa (UTC-11)</option>
                        <option value="üá¶üá© Andorra|Europe/Andorra">üá¶üá© Andorra (UTC+1)</option>
                        <option value="üá¶üá¥ Angola|Africa/Luanda">üá¶üá¥ Angola (UTC+1)</option>
                        <option value="üá¶üáÆ Anguilla|America/Anguilla">üá¶üáÆ Anguilla (UTC-4)</option>
                        <option value="üá¶üá∂ Antarctica|Antarctica/Casey">üá¶üá∂ Antarctica (UTC+8)</option>
                        <option value="üá¶üá¨ Antigua & Barbuda|America/Antigua">üá¶üá¨ Antigua & Barbuda (UTC-4)</option>
                        <option value="üá¶üá∑ Argentina|America/Argentina/Buenos_Aires">üá¶üá∑ Argentina (UTC-3)</option>
                        <option value="üá¶üá≤ Armenia|Asia/Yerevan">üá¶üá≤ Armenia (UTC+4)</option>
                        <option value="üá¶üáº Aruba|America/Aruba">üá¶üáº Aruba (UTC-4)</option>
                        <option value="üá¶üá∫ Australia|Australia/Sydney">üá¶üá∫ Australia (UTC+10)</option>
                        <option value="üá¶üáπ Austria|Europe/Vienna">üá¶üáπ Austria (UTC+1)</option>
                        <option value="üá¶üáø Azerbaijan|Asia/Baku">üá¶üáø Azerbaijan (UTC+4)</option>
                        <option value="üáßüá∏ Bahamas|America/Nassau">üáßüá∏ Bahamas (UTC-5)</option>
                        <option value="üáßüá≠ Bahrain|Asia/Bahrain">üáßüá≠ Bahrain (UTC+3)</option>
                        <option value="üáßüá© Bangladesh|Asia/Dhaka">üáßüá© Bangladesh (UTC+6)</option>
                        <option value="üáßüáß Barbados|America/Barbados">üáßüáß Barbados (UTC-4)</option>
                        <option value="üáßüáæ Belarus|Europe/Minsk">üáßüáæ Belarus (UTC+3)</option>
                        <option value="üáßüá™ Belgium|Europe/Brussels">üáßüá™ Belgium (UTC+1)</option>
                        <option value="üáßüáø Belize|America/Belize">üáßüáø Belize (UTC-6)</option>
                        <option value="üáßüáØ Benin|Africa/Porto-Novo">üáßüáØ Benin (UTC+1)</option>
                        <option value="üáßüá≤ Bermuda|Atlantic/Bermuda">üáßüá≤ Bermuda (UTC-4)</option>
                        <option value="üáßüáπ Bhutan|Asia/Thimphu">üáßüáπ Bhutan (UTC+6)</option>
                        <option value="üáßüá¥ Bolivia|America/La_Paz">üáßüá¥ Bolivia (UTC-4)</option>
                        <option value="üáßüá¶ Bosnia & Herzegovina|Europe/Sarajevo">üáßüá¶ Bosnia & Herzegovina (UTC+1)</option>
                        <option value="üáßüáº Botswana|Africa/Gaborone">üáßüáº Botswana (UTC+2)</option>
                        <option value="üáßüá∑ Brazil|America/Sao_Paulo">üáßüá∑ Brazil (UTC-3)</option>
                        <option value="üáÆüá¥ British Indian Ocean Territory|Indian/Chagos">üáÆüá¥ British Indian Ocean Territory (UTC+6)</option>
                        <option value="üáªüá¨ British Virgin Islands|America/Tortola">üáªüá¨ British Virgin Islands (UTC-4)</option>
                        <option value="üáßüá≥ Brunei|Asia/Brunei">üáßüá≥ Brunei (UTC+8)</option>
                        <option value="üáßüá¨ Bulgaria|Europe/Sofia">üáßüá¨ Bulgaria (UTC+2)</option>
                        <option value="üáßüá´ Burkina Faso|Africa/Ouagadougou">üáßüá´ Burkina Faso (UTC+0)</option>
                        <option value="üáßüáÆ Burundi|Africa/Bujumbura">üáßüáÆ Burundi (UTC+2)</option>
                        <option value="üá∞üá≠ Cambodia|Asia/Phnom_Penh">üá∞üá≠ Cambodia (UTC+7)</option>
                        <option value="üá®üá≤ Cameroon|Africa/Douala">üá®üá≤ Cameroon (UTC+1)</option>
                        <option value="üá®üá¶ Canada|America/Toronto">üá®üá¶ Canada (UTC-5)</option>
                        <option value="üá®üáª Cape Verde|Atlantic/Cape_Verde">üá®üáª Cape Verde (UTC-1)</option>
                        <option value="üáßüá∂ Caribbean Netherlands|America/Kralendijk">üáßüá∂ Caribbean Netherlands (UTC-4)</option>
                        <option value="üá∞üáæ Cayman Islands|America/Cayman">üá∞üáæ Cayman Islands (UTC-5)</option>
                        <option value="üá®üá´ Central African Republic|Africa/Bangui">üá®üá´ Central African Republic (UTC+1)</option>
                        <option value="üáπüá© Chad|Africa/Ndjamena">üáπüá© Chad (UTC+1)</option>
                        <option value="üá®üá± Chile|America/Santiago">üá®üá± Chile (UTC-4)</option>
                        <option value="üá®üá≥ China|Asia/Shanghai">üá®üá≥ China (UTC+8)</option>
                        <option value="üá®üáΩ Christmas Island|Indian/Christmas">üá®üáΩ Christmas Island (UTC+7)</option>
                        <option value="üá®üá® Cocos (Keeling) Islands|Indian/Cocos">üá®üá® Cocos (Keeling) Islands (UTC+6:30)</option>
                        <option value="üá®üá¥ Colombia|America/Bogota">üá®üá¥ Colombia (UTC-5)</option>
                        <option value="üá∞üá≤ Comoros|Indian/Comoro">üá∞üá≤ Comoros (UTC+3)</option>
                        <option value="üá®üá¨ Congo - Brazzaville|Africa/Brazzaville">üá®üá¨ Congo - Brazzaville (UTC+1)</option>
                        <option value="üá®üá© Congo - Kinshasa|Africa/Kinshasa">üá®üá© Congo - Kinshasa (UTC+1)</option>
                        <option value="üá®üá∞ Cook Islands|Pacific/Rarotonga">üá®üá∞ Cook Islands (UTC-10)</option>
                        <option value="üá®üá∑ Costa Rica|America/Costa_Rica">üá®üá∑ Costa Rica (UTC-6)</option>
                        <option value="üá≠üá∑ Croatia|Europe/Zagreb">üá≠üá∑ Croatia (UTC+1)</option>
                        <option value="üá®üá∫ Cuba|America/Havana">üá®üá∫ Cuba (UTC-5)</option>
                        <option value="üá®üáº Cura√ßao|America/Curacao">üá®üáº Cura√ßao (UTC-4)</option>
                        <option value="üá®üáæ Cyprus|Asia/Nicosia">üá®üáæ Cyprus (UTC+2)</option>
                        <option value="üá®üáø Czechia|Europe/Prague">üá®üáø Czechia (UTC+1)</option>
                        <option value="üá©üá∞ Denmark|Europe/Copenhagen">üá©üá∞ Denmark (UTC+1)</option>
                        <option value="üá©üáØ Djibouti|Africa/Djibouti">üá©üáØ Djibouti (UTC+3)</option>
                        <option value="üá©üá≤ Dominica|America/Dominica">üá©üá≤ Dominica (UTC-4)</option>
                        <option value="üá©üá¥ Dominican Republic|America/Santo_Domingo">üá©üá¥ Dominican Republic (UTC-4)</option>
                        <option value="üá™üá® Ecuador|America/Guayaquil">üá™üá® Ecuador (UTC-5)</option>
                        <option value="üá™üá¨ Egypt|Africa/Cairo">üá™üá¨ Egypt (UTC+2)</option>
                        <option value="üá∏üáª El Salvador|America/El_Salvador">üá∏üáª El Salvador (UTC-6)</option>
                        <option value="üá¨üá∂ Equatorial Guinea|Africa/Malabo">üá¨üá∂ Equatorial Guinea (UTC+1)</option>
                        <option value="üá™üá∑ Eritrea|Africa/Asmara">üá™üá∑ Eritrea (UTC+3)</option>
                        <option value="üá™üá™ Estonia|Europe/Tallinn">üá™üá™ Estonia (UTC+2)</option>
                        <option value="üá∏üáø Eswatini|Africa/Mbabane">üá∏üáø Eswatini (UTC+2)</option>
                        <option value="üá™üáπ Ethiopia|Africa/Addis_Ababa">üá™üáπ Ethiopia (UTC+3)</option>
                        <option value="üá´üá∞ Falkland Islands|Atlantic/Stanley">üá´üá∞ Falkland Islands (UTC-3)</option>
                        <option value="üá´üá¥ Faroe Islands|Atlantic/Faroe">üá´üá¥ Faroe Islands (UTC+0)</option>
                        <option value="üá´üáØ Fiji|Pacific/Fiji">üá´üáØ Fiji (UTC+12)</option>
                        <option value="üá´üáÆ Finland|Europe/Helsinki">üá´üáÆ Finland (UTC+2)</option>
                        <option value="üá´üá∑ France|Europe/Paris">üá´üá∑ France (UTC+1)</option>
                        <option value="üá¨üá´ French Guiana|America/Cayenne">üá¨üá´ French Guiana (UTC-3)</option>
                        <option value="üáµüá´ French Polynesia|Pacific/Tahiti">üáµüá´ French Polynesia (UTC-10)</option>
                        <option value="üáπüá´ French Southern Territories|Indian/Kerguelen">üáπüá´ French Southern Territories (UTC+5)</option>
                        <option value="üá¨üá¶ Gabon|Africa/Libreville">üá¨üá¶ Gabon (UTC+1)</option>
                        <option value="üá¨üá≤ Gambia|Africa/Banjul">üá¨üá≤ Gambia (UTC+0)</option>
                        <option value="üá¨üá™ Georgia|Asia/Tbilisi">üá¨üá™ Georgia (UTC+4)</option>
                        <option value="üá©üá™ Germany|Europe/Berlin">üá©üá™ Germany (UTC+1)</option>
                        <option value="üá¨üá≠ Ghana|Africa/Accra">üá¨üá≠ Ghana (UTC+0)</option>
                        <option value="üá¨üáÆ Gibraltar|Europe/Gibraltar">üá¨üáÆ Gibraltar (UTC+1)</option>
                        <option value="üá¨üá∑ Greece|Europe/Athens">üá¨üá∑ Greece (UTC+2)</option>
                        <option value="üá¨üá± Greenland|America/Godthab">üá¨üá± Greenland (UTC-3)</option>
                        <option value="üá¨üá© Grenada|America/Grenada">üá¨üá© Grenada (UTC-4)</option>
                        <option value="üá¨üáµ Guadeloupe|America/Guadeloupe">üá¨üáµ Guadeloupe (UTC-4)</option>
                        <option value="üá¨üá∫ Guam|Pacific/Guam">üá¨üá∫ Guam (UTC+10)</option>
                        <option value="üá¨üáπ Guatemala|America/Guatemala">üá¨üáπ Guatemala (UTC-6)</option>
                        <option value="üá¨üá¨ Guernsey|Europe/Guernsey">üá¨üá¨ Guernsey (UTC+0)</option>
                        <option value="üá¨üá≥ Guinea|Africa/Conakry">üá¨üá≥ Guinea (UTC+0)</option>
                        <option value="üá¨üáº Guinea-Bissau|Africa/Bissau">üá¨üáº Guinea-Bissau (UTC+0)</option>
                        <option value="üá¨üáæ Guyana|America/Guyana">üá¨üáæ Guyana (UTC-4)</option>
                        <option value="üá≠üáπ Haiti|America/Port-au-Prince">üá≠üáπ Haiti (UTC-5)</option>
                        <option value="üá≠üá≥ Honduras|America/Tegucigalpa">üá≠üá≥ Honduras (UTC-6)</option>
                        <option value="üá≠üá∞ Hong Kong|Asia/Hong_Kong">üá≠üá∞ Hong Kong (UTC+8)</option>
                        <option value="üá≠üá∫ Hungary|Europe/Budapest">üá≠üá∫ Hungary (UTC+1)</option>
                        <option value="üáÆüá∏ Iceland|Atlantic/Reykjavik">üáÆüá∏ Iceland (UTC+0)</option>
                        <option value="üáÆüá≥ India|Asia/Kolkata">üáÆüá≥ India (UTC+5:30)</option>
                        <option value="üáÆüá© Indonesia|Asia/Jakarta">üáÆüá© Indonesia (UTC+7)</option>
                        <option value="üáÆüá∑ Iran|Asia/Tehran">üáÆüá∑ Iran (UTC+3:30)</option>
                        <option value="üáÆüá∂ Iraq|Asia/Baghdad">üáÆüá∂ Iraq (UTC+3)</option>
                        <option value="üáÆüá™ Ireland|Europe/Dublin">üáÆüá™ Ireland (UTC+0)</option>
                        <option value="üáÆüá≤ Isle of Man|Europe/Isle_of_Man">üáÆüá≤ Isle of Man (UTC+0)</option>
                        <option value="üáÆüá± Israel|Asia/Jerusalem">üáÆüá± Israel (UTC+2)</option>
                        <option value="üáÆüáπ Italy|Europe/Rome">üáÆüáπ Italy (UTC+1)</option>
                        <option value="üá®üáÆ Ivory Coast|Africa/Abidjan">üá®ÔøΩÔøΩ Ivory Coast (UTC+0)</option>
                        <option value="üáØüá≤ Jamaica|America/Jamaica">üáØüá≤ Jamaica (UTC-5)</option>
                        <option value="üáØüáµ Japan|Asia/Tokyo">üáØüáµ Japan (UTC+9)</option>
                        <option value="üáØüá™ Jersey|Europe/Jersey">üáØüá™ Jersey (UTC+0)</option>
                        <option value="üáØüá¥ Jordan|Asia/Amman">üáØüá¥ Jordan (UTC+2)</option>
                        <option value="üá∞üáø Kazakhstan|Asia/Almaty">üá∞üáø Kazakhstan (UTC+6)</option>
                        <option value="üá∞üá™ Kenya|Africa/Nairobi">üá∞üá™ Kenya (UTC+3)</option>
                        <option value="üá∞üáÆ Kiribati|Pacific/Tarawa">üá∞üáÆ Kiribati (UTC+12)</option>
                        <option value="üáΩüá∞ Kosovo|Europe/Belgrade">üáΩüá∞ Kosovo (UTC+1)</option>
                        <option value="üá∞üáº Kuwait|Asia/Kuwait">üá∞üáº Kuwait (UTC+3)</option>
                        <option value="üá∞üá¨ Kyrgyzstan|Asia/Bishkek">üá∞üá¨ Kyrgyzstan (UTC+6)</option>
                        <option value="üá±üá¶ Laos|Asia/Vientiane">üá±üá¶ Laos (UTC+7)</option>
                        <option value="üá±üáª Latvia|Europe/Riga">üá±üáª Latvia (UTC+2)</option>
                        <option value="üá±üáß Lebanon|Asia/Beirut">üá±üáß Lebanon (UTC+2)</option>
                        <option value="üá±üá∏ Lesotho|Africa/Maseru">üá±üá∏ Lesotho (UTC+2)</option>
                        <option value="üá±üá∑ Liberia|Africa/Monrovia">üá±üá∑ Liberia (UTC+0)</option>
                        <option value="üá±üáæ Libya|Africa/Tripoli">üá±üáæ Libya (UTC+2)</option>
                        <option value="üá±üáÆ Liechtenstein|Europe/Vaduz">üá±üáÆ Liechtenstein (UTC+1)</option>
                        <option value="üá±üáπ Lithuania|Europe/Vilnius">üá±üáπ Lithuania (UTC+2)</option>
                        <option value="üá±üá∫ Luxembourg|Europe/Luxembourg">üá±üá∫ Luxembourg (UTC+1)</option>
                        <option value="üá≤üá¥ Macao|Asia/Macau">üá≤üá¥ Macao (UTC+8)</option>
                        <option value="üá≤üá∞ North Macedonia|Europe/Skopje">üá≤üá∞ North Macedonia (UTC+1)</option>
                        <option value="üá≤üá¨ Madagascar|Indian/Antananarivo">üá≤üá¨ Madagascar (UTC+3)</option>
                        <option value="üá≤üáº Malawi|Africa/Blantyre">üá≤üáº Malawi (UTC+2)</option>
                        <option value="üá≤üáæ Malaysia|Asia/Kuala_Lumpur">üá≤üáæ Malaysia (UTC+8)</option>
                        <option value="üá≤üáª Maldives|Indian/Maldives">üá≤üáª Maldives (UTC+5)</option>
                        <option value="üá≤üá± Mali|Africa/Bamako">üá≤üá± Mali (UTC+0)</option>
                        <option value="üá≤üáπ Malta|Europe/Malta">üá≤üáπ Malta (UTC+1)</option>
                        <option value="üá≤üá≠ Marshall Islands|Pacific/Majuro">üá≤üá≠ Marshall Islands (UTC+12)</option>
                        <option value="üá≤üá∂ Martinique|America/Martinique">üá≤üá∂ Martinique (UTC-4)</option>
                        <option value="üá≤üá∑ Mauritania|Africa/Nouakchott">üá≤üá∑ Mauritania (UTC+0)</option>
                        <option value="üá≤üá∫ Mauritius|Indian/Mauritius">üá≤üá∫ Mauritius (UTC+4)</option>
                        <option value="üáæüáπ Mayotte|Indian/Mayotte">üáæüáπ Mayotte (UTC+3)</option>
                        <option value="üá≤üáΩ Mexico|America/Mexico_City">üá≤üáΩ Mexico (UTC-6)</option>
                        <option value="üá´üá≤ Micronesia|Pacific/Chuuk">üá´üá≤ Micronesia (UTC+10)</option>
                        <option value="üá≤üá© Moldova|Europe/Chisinau">üá≤üá© Moldova (UTC+2)</option>
                        <option value="üá≤üá® Monaco|Europe/Monaco">üá≤üá® Monaco (UTC+1)</option>
                        <option value="üá≤üá≥ Mongolia|Asia/Ulaanbaatar">üá≤üá≥ Mongolia (UTC+8)</option>
                        <option value="üá≤üá™ Montenegro|Europe/Podgorica">üá≤üá™ Montenegro (UTC+1)</option>
                        <option value="üá≤üá∏ Montserrat|America/Montserrat">üá≤üá∏ Montserrat (UTC-4)</option>
                        <option value="üá≤üá¶ Morocco|Africa/Casablanca">üá≤üá¶ Morocco (UTC+1)</option>
                        <option value="üá≤üáø Mozambique|Africa/Maputo">üá≤üáø Mozambique (UTC+2)</option>
                        <option value="üá≤üá≤ Myanmar (Burma)|Asia/Yangon">üá≤üá≤ Myanmar (Burma) (UTC+6:30)</option>
                        <option value="üá≥üá¶ Namibia|Africa/Windhoek">üá≥üá¶ Namibia (UTC+2)</option>
                        <option value="üá≥üá∑ Nauru|Pacific/Nauru">üá≥üá∑ Nauru (UTC+12)</option>
                        <option value="üá≥üáµ Nepal|Asia/Kathmandu">üá≥üáµ Nepal (UTC+5:45)</option>
                        <option value="üá≥üá± Netherlands|Europe/Amsterdam">üá≥üá± Netherlands (UTC+1)</option>
                        <option value="üá≥üá® New Caledonia|Pacific/Noumea">üá≥üá® New Caledonia (UTC+11)</option>
                        <option value="üá≥üáø New Zealand|Pacific/Auckland">üá≥üáø New Zealand (UTC+12)</option>
                        <option value="üá≥üáÆ Nicaragua|America/Managua">üá≥üáÆ Nicaragua (UTC-6)</option>
                        <option value="üá≥üá™ Niger|Africa/Niamey">üá≥üá™ Niger (UTC+1)</option>
                        <option value="üá≥üá¨ Nigeria|Africa/Lagos">üá≥üá¨ Nigeria (UTC+1)</option>
                        <option value="üá≥üá∫ Niue|Pacific/Niue">üá≥üá∫ Niue (UTC-11)</option>
                        <option value="üá≥üá´ Norfolk Island|Pacific/Norfolk">üá≥üá´ Norfolk Island (UTC+11)</option>
                        <option value="üá∞üáµ North Korea|Asia/Pyongyang">üá∞üáµ North Korea (UTC+9)</option>
                        <option value="üá≤üá∞ North Macedonia|Europe/Skopje">üá≤üá∞ North Macedonia (UTC+1)</option>
                        <option value="üá≤üáµ Northern Mariana Islands|Pacific/Saipan">üá≤üáµ Northern Mariana Islands (UTC+10)</option>
                        <option value="üá≥üá¥ Norway|Europe/Oslo">üá≥üá¥ Norway (UTC+1)</option>
                        <option value="üá¥üá≤ Oman|Asia/Muscat">üá¥üá≤ Oman (UTC+4)</option>
                        <option value="üáµüá∞ Pakistan|Asia/Karachi">üáµüá∞ Pakistan (UTC+5)</option>
                        <option value="üáµüáº Palau|Pacific/Palau">üáµüáº Palau (UTC+9)</option>
                        <option value="üáµüá∏ Palestine|Asia/Gaza">üáµüá∏ Palestine (UTC+2)</option>
                        <option value="üáµüá¶ Panama|America/Panama">üáµüá¶ Panama (UTC-5)</option>
                        <option value="üáµüá¨ Papua New Guinea|Pacific/Port_Moresby">üáµüá¨ Papua New Guinea (UTC+10)</option>
                        <option value="üáµüáæ Paraguay|America/Asuncion">üáµüáæ Paraguay (UTC-4)</option>
                        <option value="üáµüá™ Peru|America/Lima">üáµüá™ Peru (UTC-5)</option>
                        <option value="üáµüá≠ Philippines|Asia/Manila">üáµüá≠ Philippines (UTC+8)</option>
                        <option value="üáµüá≥ Pitcairn Islands|Pacific/Pitcairn">üáµüá≥ Pitcairn Islands (UTC-8)</option>
                        <option value="üáµüá± Poland|Europe/Warsaw">üáµüá± Poland (UTC+1)</option>
                        <option value="üáµüáπ Portugal|Europe/Lisbon">üáµüáπ Portugal (UTC+0)</option>
                        <option value="üáµüá∑ Puerto Rico|America/Puerto_Rico">üáµüá∑ Puerto Rico (UTC-4)</option>
                        <option value="üá∂üá¶ Qatar|Asia/Qatar">üá∂üá¶ Qatar (UTC+3)</option>
                        <option value="üá∑üá¥ Romania|Europe/Bucharest">üá∑üá¥ Romania (UTC+2)</option>
                        <option value="üá∑üá∫ Russia|Europe/Moscow">üá∑üá∫ Russia (UTC+3)</option>
                        <option value="üá∑üáº Rwanda|Africa/Kigali">üá∑üáº Rwanda (UTC+2)</option>
                        <option value="üáºüá∏ Samoa|Pacific/Apia">üáºüá∏ Samoa (UTC+13)</option>
                        <option value="üá∏üá≤ San Marino|Europe/San_Marino">üá∏üá≤ San Marino (UTC+1)</option>
                        <option value="üá∏üáπ S√£o Tom√© & Pr√≠ncipe|Africa/Sao_Tome">üá∏üáπ S√£o Tom√© & Pr√≠ncipe (UTC+0)</option>
                        <option value="üá∏üá¶ Saudi Arabia|Asia/Riyadh">üá∏üá¶ Saudi Arabia (UTC+3)</option>
                        <option value="üá∏üá≥ Senegal|Africa/Dakar">üá∏üá≥ Senegal (UTC+0)</option>
                        <option value="üá∑üá∏ Serbia|Europe/Belgrade">üá∑üá∏ Serbia (UTC+1)</option>
                        <option value="üá∏üá® Seychelles|Indian/Mahe">üá∏üá® Seychelles (UTC+4)</option>
                        <option value="üá∏üá± Sierra Leone|Africa/Freetown">üá∏üá± Sierra Leone (UTC+0)</option>
                        <option value="üá∏üá¨ Singapore|Asia/Singapore">üá∏üá¨ Singapore (UTC+8)</option>
                        <option value="üá∏üáΩ Sint Maarten|America/Lower_Princes">üá∏üáΩ Sint Maarten (UTC-4)</option>
                        <option value="üá∏üá∞ Slovakia|Europe/Bratislava">üá∏üá∞ Slovakia (UTC+1)</option>
                        <option value="üá∏üáÆ Slovenia|Europe/Ljubljana">üá∏üáÆ Slovenia (UTC+1)</option>
                        <option value="üá∏üáß Solomon Islands|Pacific/Guadalcanal">üá∏üáß Solomon Islands (UTC+11)</option>
                        <option value="üá∏üá¥ Somalia|Africa/Mogadishu">üá∏üá¥ Somalia (UTC+3)</option>
                        <option value="üáøüá¶ South Africa|Africa/Johannesburg">üáøüá¶ South Africa (UTC+2)</option>
                        <option value="üá∞üá∑ South Korea|Asia/Seoul">üá∞üá∑ South Korea (UTC+9)</option>
                        <option value="üá∏üá∏ South Sudan|Africa/Juba">üá∏üá∏ South Sudan (UTC+3)</option>
                        <option value="üá™üá∏ Spain|Europe/Madrid">üá™üá∏ Spain (UTC+1)</option>
                        <option value="üá±üá∞ Sri Lanka|Asia/Colombo">üá±üá∞ Sri Lanka (UTC+5:30)</option>
                        <option value="üáßüá± St. Barth√©lemy|America/St_Barthelemy">üáßüá± St. Barth√©lemy (UTC-4)</option>
                        <option value="üá∏üá≠ St. Helena|Atlantic/St_Helena">üá∏üá≠ St. Helena (UTC+0)</option>
                        <option value="üá∞üá≥ St. Kitts & Nevis|America/St_Kitts">üá∞üá≥ St. Kitts & Nevis (UTC-4)</option>
                        <option value="üá±üá® St. Lucia|America/St_Lucia">üá±üá® St. Lucia (UTC-4)</option>
                        <option value="üá≤üá´ St. Martin|America/Marigot">üá≤üá´ St. Martin (UTC-4)</option>
                        <option value="üáµüá≤ St. Pierre & Miquelon|America/Miquelon">üáµüá≤ St. Pierre & Miquelon (UTC-3)</option>
                        <option value="üáªüá® St. Vincent & Grenadines|America/St_Vincent">üáªüá® St. Vincent & Grenadines (UTC-4)</option>
                        <option value="üá∏üá© Sudan|Africa/Khartoum">üá∏üá© Sudan (UTC+2)</option>
                        <option value="üá∏üá∑ Suriname|America/Paramaribo">üá∏üá∑ Suriname (UTC-3)</option>
                        <option value="üá∏üáØ Svalbard & Jan Mayen|Arctic/Longyearbyen">üá∏üáØ Svalbard & Jan Mayen (UTC+1)</option>
                        <option value="üá∏üá™ Sweden|Europe/Stockholm">üá∏üá™ Sweden (UTC+1)</option>
                        <option value="üá®üá≠ Switzerland|Europe/Zurich">üá®üá≠ Switzerland (UTC+1)</option>
                        <option value="üá∏üáæ Syria|Asia/Damascus">üá∏üáæ Syria (UTC+2)</option>
                        <option value="üáπüáº Taiwan|Asia/Taipei">üáπüáº Taiwan (UTC+8)</option>
                        <option value="üáπüáØ Tajikistan|Asia/Dushanbe">üáπüáØ Tajikistan (UTC+5)</option>
                        <option value="üáπüáø Tanzania|Africa/Dar_es_Salaam">üáπüáø Tanzania (UTC+3)</option>
                        <option value="üáπüá≠ Thailand|Asia/Bangkok">üáπüá≠ Thailand (UTC+7)</option>
                        <option value="üáπüá± Timor-Leste|Asia/Dili">üáπüá± Timor-Leste (UTC+9)</option>
                        <option value="üáπüá¨ Togo|Africa/Lome">üáπüá¨ Togo (UTC+0)</option>
                        <option value="üáπüá∞ Tokelau|Pacific/Fakaofo">üáπüá∞ Tokelau (UTC+13)</option>
                        <option value="üáπüá¥ Tonga|Pacific/Tongatapu">üáπüá¥ Tonga (UTC+13)</option>
                        <option value="üáπüáπ Trinidad & Tobago|America/Port_of_Spain">üáπüáπ Trinidad & Tobago (UTC-4)</option>
                        <option value="üáπüá≥ Tunisia|Africa/Tunis">üáπüá≥ Tunisia (UTC+1)</option>
                        <option value="üáπüá∑ Turkey|Europe/Istanbul">üáπüá∑ Turkey (UTC+3)</option>
                        <option value="üáπüá≤ Turkmenistan|Asia/Ashgabat">üáπüá≤ Turkmenistan (UTC+5)</option>
                        <option value="üáπüá® Turks & Caicos Islands|America/Grand_Turk">üáπüá® Turks & Caicos Islands (UTC-5)</option>
                        <option value="üáπüáª Tuvalu|Pacific/Funafuti">üáπüáª Tuvalu (UTC+12)</option>
                        <option value="üá∫üá¨ Uganda|Africa/Kampala">üá∫üá¨ Uganda (UTC+3)</option>
                        <option value="üá∫üá¶ Ukraine|Europe/Kiev">üá∫üá¶ Ukraine (UTC+2)</option>
                        <option value="üá¶üá™ United Arab Emirates|Asia/Dubai">üá¶üá™ United Arab Emirates (UTC+4)</option>
                        <option value="üá¨üáß United Kingdom|Europe/London">üá¨üáß United Kingdom (UTC+0)</option>
                        <option value="üá∫üá∏ United States|America/New_York">üá∫üá∏ United States (UTC-5)</option>
                        <option value="üá∫üáæ Uruguay|America/Montevideo">üá∫üáæ Uruguay (UTC-3)</option>
                        <option value="üá∫üáø Uzbekistan|Asia/Tashkent">üá∫üáø Uzbekistan (UTC+5)</option>
                        <option value="üáªüá∫ Vanuatu|Pacific/Efate">üáªüá∫ Vanuatu (UTC+11)</option>
                        <option value="üáªüá¶ Vatican City|Europe/Vatican">üáªüá¶ Vatican City (UTC+1)</option>
                        <option value="üáªüá™ Venezuela|America/Caracas">üáªüá™ Venezuela (UTC-4)</option>
                        <option value="üáªüá≥ Vietnam|Asia/Ho_Chi_Minh">üáªüá≥ Vietnam (UTC+7)</option>
                        <option value="üáºüá´ Wallis & Futuna|Pacific/Wallis">üáºüá´ Wallis & Futuna (UTC+12)</option>
                        <option value="üá™üá≠ Western Sahara|Africa/El_Aaiun">üá™üá≠ Western Sahara (UTC+0)</option>
                        <option value="üáæüá™ Yemen|Asia/Aden">üáæüá™ Yemen (UTC+3)</option>
                        <option value="üáøüá≤ Zambia|Africa/Lusaka">üáøüá≤ Zambia (UTC+2)</option>
                        <option value="üáøüáº Zimbabwe|Africa/Harare">üáøüáº Zimbabwe (UTC+2)</option>
                        <option value="üåç Global|Etc/UTC">üåç Global (UTC)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="comments">Additional comments (optional):</label>
                    <textarea id="comments" name="comments" rows="4" placeholder="Tell us more about your news preferences, specific sources you like, or any other relevant information..."></textarea>
                </div>
                
                <button type="submit" class="submit-btn" id="submitBtn">Send Preferences</button>
            </form>
            
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>Sending your preferences...</p>
            </div>
            
            <div id="successMessage" class="success-message" style="display: none;">
                <h3>Thank you for your preferences!</h3>
                <p>We have received your information and you will soon start receiving personalized news according to your interests. Our n8n system will process your preferences and activate a personalized flow for you.</p>
                <a href="https://t.me/Simply_news_chat" class="cta-button">Join Telegram Group</a>
            </div>
        </div>
    </section>

    <script>
        // Handle "Other" checkbox functionality
        document.getElementById('otherCheckbox').addEventListener('change', function() {
            const searchContainer = document.getElementById('searchContainer');
            if (this.checked) {
                searchContainer.classList.add('active');
            } else {
                searchContainer.classList.remove('active');
                document.getElementById('searchInput').value = '';
                document.getElementById('searchResults').style.display = 'none';
            }
        });

        // Search functionality with n8n integration
        let searchTimeout;
        document.getElementById('searchInput').addEventListener('input', function() {
            const query = this.value.trim();
            const searchResults = document.getElementById('searchResults');
            
            clearTimeout(searchTimeout);
            
            if (query.length < 2) {
                searchResults.style.display = 'none';
                return;
            }
            
            searchTimeout = setTimeout(async () => {
                try {
                    // Replace with your n8n search webhook URL
                    const searchWebhookUrl = 'TU_URL_DEL_WEBHOOK_BUSQUEDA_N8N_AQUI';
                    
                    const response = await fetch(searchWebhookUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            query: query,
                            type: 'topic_search'
                        })
                    });
                    
                    if (response.ok) {
                        const results = await response.json();
                        displaySearchResults(results);
                    } else {
                        // Fallback to local search if n8n is not available
                        const fallbackResults = getFallbackSearchResults(query);
                        displaySearchResults(fallbackResults);
                    }
                } catch (error) {
                    console.error('Search error:', error);
                    // Fallback to local search
                    const fallbackResults = getFallbackSearchResults(query);
                    displaySearchResults(fallbackResults);
                }
            }, 300);
        });

        function displaySearchResults(results) {
            const searchResults = document.getElementById('searchResults');
            searchResults.innerHTML = '';
            
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="search-result-item">No results found</div>';
            } else {
                results.forEach(result => {
                    const item = document.createElement('div');
                    item.className = 'search-result-item';
                    item.textContent = result.name || result;
                    item.addEventListener('click', () => {
                        document.getElementById('searchInput').value = result.name || result;
                        searchResults.style.display = 'none';
                    });
                    searchResults.appendChild(item);
                });
            }
            
            searchResults.style.display = 'block';
        }

        function getFallbackSearchResults(query) {
            const fallbackTopics = [
                'Cryptocurrency', 'Blockchain', 'Climate Change', 'Renewable Energy',
                'Space Exploration', 'Mars Mission', 'Electric Vehicles', 'Quantum Computing',
                'Machine Learning', 'Data Science', 'Cybersecurity', 'Digital Privacy',
                'Social Media', 'Gaming', 'E-sports', 'Virtual Reality', 'Augmented Reality',
                '5G Technology', 'Internet of Things', 'Smart Cities', 'Fintech',
                'Biotechnology', 'Gene Editing', 'Vaccines', 'Mental Health',
                'Sustainable Living', 'Zero Waste', 'Plant-based Diet', 'Fitness',
                'Travel', 'Tourism', 'Aviation', 'Maritime', 'Logistics', 'Supply Chain'
            ];
            
            return fallbackTopics.filter(topic => 
                topic.toLowerCase().includes(query.toLowerCase())
            ).slice(0, 10);
        }

        // Mapeo de idiomas soportados por pa√≠s en NewsAPI
        const countryLanguages = {
            ca: ['en', 'fr'],
            ch: ['de', 'fr', 'it'],
            be: ['nl', 'fr'],
            ae: ['ar', 'en'],
            ma: ['ar', 'fr'],
            eg: ['ar', 'en'],
            il: ['he', 'en'],
            in: ['en', 'hi'],
            sg: ['en', 'zh'],
            my: ['en', 'zh'],
            za: ['en', 'af'],
            // ... agrega m√°s pa√≠ses con varios idiomas ...
        };
        // Lista de idiomas soportados por NewsAPI
        const languageNames = {
            ar: 'Arabic',
            de: 'German',
            en: 'English',
            es: 'Spanish',
            fr: 'French',
            he: 'Hebrew',
            it: 'Italian',
            nl: 'Dutch',
            no: 'Norwegian',
            pt: 'Portuguese',
            ru: 'Russian',
            se: 'Swedish',
            ud: 'Urdu',
            zh: 'Chinese',
            hi: 'Hindi',
            ja: 'Japanese',
            ko: 'Korean',
            af: 'Afrikaans',
            th: 'Thai',
            vi: 'Vietnamese',
            tr: 'Turkish',
        };
        // Lista de fuentes por pa√≠s+idioma - Base de datos completa de medios internacionales
        const sourcesByCountryLang = {
            // ESTADOS UNIDOS (English)
            'us_en': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'cnn', label: 'CNN' },
                { value: 'fox-news', label: 'Fox News' },
                { value: 'nbc-news', label: 'NBC News' },
                { value: 'abc-news', label: 'ABC News' },
                { value: 'cbs-news', label: 'CBS News' },
                { value: 'msnbc', label: 'MSNBC' },
                { value: 'the-new-york-times', label: 'The New York Times' },
                { value: 'the-washington-post', label: 'The Washington Post' },
                { value: 'the-wall-street-journal', label: 'The Wall Street Journal' },
                { value: 'usa-today', label: 'USA Today' },
                { value: 'reuters', label: 'Reuters' },
                { value: 'associated-press', label: 'Associated Press' },
                { value: 'bloomberg', label: 'Bloomberg' },
                { value: 'politico', label: 'Politico' },
                { value: 'the-hill', label: 'The Hill' },
                { value: 'npr', label: 'NPR' },
                { value: 'pbs', label: 'PBS NewsHour' },
                { value: 'time', label: 'Time Magazine' },
                { value: 'newsweek', label: 'Newsweek' },
                { value: 'the-huffington-post', label: 'HuffPost' },
                { value: 'buzzfeed', label: 'BuzzFeed News' },
                { value: 'vox', label: 'Vox' },
                { value: 'axios', label: 'Axios' },
                { value: 'the-daily-beast', label: 'The Daily Beast' }
            ],
            
            // REINO UNIDO (English)
            'gb_en': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'bbc-news', label: 'BBC News' },
                { value: 'the-guardian-uk', label: 'The Guardian' },
                { value: 'independent', label: 'The Independent' },
                { value: 'the-telegraph', label: 'The Telegraph' },
                { value: 'daily-mail', label: 'Daily Mail' },
                { value: 'the-times', label: 'The Times' },
                { value: 'sky-news', label: 'Sky News' },
                { value: 'itv-news', label: 'ITV News' },
                { value: 'channel-4-news', label: 'Channel 4 News' },
                { value: 'financial-times', label: 'Financial Times' },
                { value: 'the-economist', label: 'The Economist' },
                { value: 'reuters-uk', label: 'Reuters UK' },
                { value: 'metro-uk', label: 'Metro UK' },
                { value: 'evening-standard', label: 'Evening Standard' },
                { value: 'the-sun', label: 'The Sun' },
                { value: 'mirror', label: 'Mirror' },
                { value: 'express', label: 'Express' },
                { value: 'the-star', label: 'The Star' },
                { value: 'huffpost-uk', label: 'HuffPost UK' },
                { value: 'buzzfeed-uk', label: 'BuzzFeed UK' }
            ],
            
            // CANAD√Å (English)
            'ca_en': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'cbc-news', label: 'CBC News' },
                { value: 'ctv-news', label: 'CTV News' },
                { value: 'global-news', label: 'Global News' },
                { value: 'national-post', label: 'National Post' },
                { value: 'the-globe-and-mail', label: 'The Globe and Mail' },
                { value: 'toronto-star', label: 'Toronto Star' },
                { value: 'montreal-gazette', label: 'Montreal Gazette' },
                { value: 'vancouver-sun', label: 'Vancouver Sun' },
                { value: 'edmonton-journal', label: 'Edmonton Journal' },
                { value: 'calgary-herald', label: 'Calgary Herald' },
                { value: 'ottawa-citizen', label: 'Ottawa Citizen' },
                { value: 'winnipeg-free-press', label: 'Winnipeg Free Press' },
                { value: 'the-province', label: 'The Province' },
                { value: 'toronto-sun', label: 'Toronto Sun' },
                { value: 'huffpost-canada', label: 'HuffPost Canada' },
                { value: 'cbc-sports', label: 'CBC Sports' },
                { value: 'tsn', label: 'TSN' },
                { value: 'sportsnet', label: 'Sportsnet' },
                { value: 'macleans', label: "Maclean's" },
                { value: 'canoe', label: 'Canoe.com' }
            ],
            
            // CANAD√Å (French)
            'ca_fr': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'radio-canada', label: 'Radio-Canada' },
                { value: 'tva-nouvelles', label: 'TVA Nouvelles' },
                { value: 'la-presse', label: 'La Presse' },
                { value: 'le-devoir', label: 'Le Devoir' },
                { value: 'journal-de-montreal', label: 'Journal de Montr√©al' },
                { value: 'journal-de-quebec', label: 'Journal de Qu√©bec' },
                { value: 'le-soleil', label: 'Le Soleil' },
                { value: 'la-tribune', label: 'La Tribune' },
                { value: 'le-nouvelliste', label: 'Le Nouvelliste' },
                { value: 'l-actualite', label: "L'actualit√©" },
                { value: 'le-figaro-canada', label: 'Le Figaro Canada' },
                { value: 'ici-radio-canada', label: 'ICI Radio-Canada' },
                { value: 'noovo-info', label: 'Noovo Info' },
                { value: 'rds', label: 'RDS' },
                { value: 'tva-sports', label: 'TVA Sports' }
            ],
            
            // FRANCIA (French)
            'fr_fr': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'le-monde', label: 'Le Monde' },
                { value: 'le-figaro', label: 'Le Figaro' },
                { value: 'liberation', label: 'Lib√©ration' },
                { value: 'le-parisien', label: 'Le Parisien' },
                { value: 'france24', label: 'France 24' },
                { value: 'bfm-tv', label: 'BFM TV' },
                { value: 'tf1-info', label: 'TF1 Info' },
                { value: 'france2', label: 'France 2' },
                { value: 'france-inter', label: 'France Inter' },
                { value: 'rtl', label: 'RTL' },
                { value: 'europe1', label: 'Europe 1' },
                { value: 'franceinfo', label: 'Franceinfo' },
                { value: 'lemonde-diplomatique', label: 'Le Monde Diplomatique' },
                { value: 'nouvel-obs', label: 'Le Nouvel Observateur' },
                { value: 'l-express', label: "L'Express" },
                { value: 'marianne', label: 'Marianne' },
                { value: 'charlie-hebdo', label: 'Charlie Hebdo' },
                { value: 'le-point', label: 'Le Point' },
                { value: 'l-equipe', label: "L'√âquipe" },
                { value: 'les-echos', label: 'Les √âchos' },
                { value: 'ouest-france', label: 'Ouest-France' }
            ],
            
            // ALEMANIA (German)
            'de_de': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'spiegel', label: 'Der Spiegel' },
                { value: 'bild', label: 'Bild' },
                { value: 'zeit', label: 'Die Zeit' },
                { value: 'faz', label: 'Frankfurter Allgemeine Zeitung' },
                { value: 'sueddeutsche', label: 'S√ºddeutsche Zeitung' },
                { value: 'welt', label: 'Die Welt' },
                { value: 'focus', label: 'Focus' },
                { value: 'stern', label: 'Stern' },
                { value: 'ard', label: 'ARD' },
                { value: 'zdf', label: 'ZDF' },
                { value: 'rtl-news', label: 'RTL News' },
                { value: 'n-tv', label: 'n-tv' },
                { value: 'deutsche-welle', label: 'Deutsche Welle' },
                { value: 'tagesschau', label: 'Tagesschau' },
                { value: 'handelsblatt', label: 'Handelsblatt' },
                { value: 'frankfurter-rundschau', label: 'Frankfurter Rundschau' },
                { value: 'tagesspiegel', label: 'Der Tagesspiegel' },
                { value: 'berliner-zeitung', label: 'Berliner Zeitung' },
                { value: 'taz', label: 'taz' },
                { value: 'kicker', label: 'Kicker' },
                { value: 'sport1', label: 'Sport1' }
            ],
            
            // ESPA√ëA (Spanish)
            'es_es': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'el-pais', label: 'El Pa√≠s' },
                { value: 'el-mundo', label: 'El Mundo' },
                { value: 'abc-espana', label: 'ABC Espa√±a' },
                { value: 'la-vanguardia', label: 'La Vanguardia' },
                { value: 'el-periodico', label: 'El Peri√≥dico' },
                { value: 'marca', label: 'Marca' },
                { value: 'as', label: 'AS' },
                { value: 'sport', label: 'Sport' },
                { value: 'mundo-deportivo', label: 'Mundo Deportivo' },
                { value: 'rtve', label: 'RTVE' },
                { value: 'antena3', label: 'Antena 3' },
                { value: 'telecinco', label: 'Telecinco' },
                { value: 'la-sexta', label: 'La Sexta' },
                { value: 'cuatro', label: 'Cuatro' },
                { value: 'el-confidencial', label: 'El Confidencial' },
                { value: 'publico', label: 'P√∫blico' },
                { value: 'eldiario-es', label: 'elDiario.es' },
                { value: 'ok-diario', label: 'OK Diario' },
                { value: 'la-razon', label: 'La Raz√≥n' },
                { value: 'el-espanol', label: 'El Espa√±ol' },
                { value: '20-minutos', label: '20 Minutos' }
            ],
            
            // ITALIA (Italian)
            'it_it': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'corriere-della-sera', label: 'Corriere della Sera' },
                { value: 'la-repubblica', label: 'La Repubblica' },
                { value: 'la-gazzetta-dello-sport', label: 'La Gazzetta dello Sport' },
                { value: 'la-stampa', label: 'La Stampa' },
                { value: 'il-sole-24-ore', label: 'Il Sole 24 Ore' },
                { value: 'rai-news', label: 'Rai News' },
                { value: 'mediaset', label: 'Mediaset' },
                { value: 'sky-tg24', label: 'Sky TG24' },
                { value: 'la7', label: 'La7' },
                { value: 'ansa', label: 'ANSA' },
                { value: 'il-giornale', label: 'Il Giornale' },
                { value: 'il-fatto-quotidiano', label: 'Il Fatto Quotidiano' },
                { value: 'huffpost-italy', label: 'HuffPost Italia' },
                { value: 'fanpage', label: 'Fanpage' },
                { value: 'tuttosport', label: 'Tuttosport' },
                { value: 'corriere-dello-sport', label: 'Corriere dello Sport' },
                { value: 'agi', label: 'AGI' },
                { value: 'adnkronos', label: 'Adnkronos' },
                { value: 'il-messaggero', label: 'Il Messaggero' },
                { value: 'tgcom24', label: 'Tgcom24' },
                { value: 'il-tempo', label: 'Il Tempo' }
            ],
            
            // JAP√ìN (Japanese)
            'jp_ja': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'nhk', label: 'NHK News' },
                { value: 'asahi', label: 'Asahi Shimbun' },
                { value: 'mainichi', label: 'Mainichi Shimbun' },
                { value: 'yomiuri', label: 'Yomiuri Shimbun' },
                { value: 'nikkei', label: 'Nikkei' },
                { value: 'sankei', label: 'Sankei Shimbun' },
                { value: 'kyodo', label: 'Kyodo News' },
                { value: 'jiji', label: 'Jiji Press' },
                { value: 'tbs-news', label: 'TBS News' },
                { value: 'fuji-tv', label: 'Fuji TV' },
                { value: 'tv-asahi', label: 'TV Asahi' },
                { value: 'ntv', label: 'Nippon TV' },
                { value: 'tv-tokyo', label: 'TV Tokyo' },
                { value: 'tokyo-shimbun', label: 'Tokyo Shimbun' },
                { value: 'chunichi', label: 'Chunichi Shimbun' },
                { value: 'hokkaido', label: 'Hokkaido Shimbun' },
                { value: 'sports-nippon', label: 'Sports Nippon' },
                { value: 'sponichi', label: 'Sponichi' },
                { value: 'nikkan-sports', label: 'Nikkan Sports' },
                { value: 'hochi', label: 'Sports Hochi' },
                { value: 'yahoo-japan', label: 'Yahoo! Japan News' }
            ],
            
            // CHINA (Chinese)
            'cn_zh': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'xinhua', label: 'Xinhua News' },
                { value: 'peoples-daily', label: "People's Daily" },
                { value: 'cctv', label: 'CCTV' },
                { value: 'cgtn', label: 'CGTN' },
                { value: 'china-daily-cn', label: 'China Daily (‰∏≠Êñá)' },
                { value: 'beijing-news', label: 'Beijing News' },
                { value: 'southern-daily', label: 'Southern Daily' },
                { value: 'guangming-daily', label: 'Guangming Daily' },
                { value: 'economic-daily', label: 'Economic Daily' },
                { value: 'china-youth-daily', label: 'China Youth Daily' },
                { value: 'workers-daily', label: "Workers' Daily" },
                { value: 'legal-daily', label: 'Legal Daily' },
                { value: 'science-technology-daily', label: 'Science & Technology Daily' },
                { value: 'china-education-daily', label: 'China Education Daily' },
                { value: 'health-news', label: 'Health News' },
                { value: 'china-sports-daily', label: 'China Sports Daily' },
                { value: 'china-culture-daily', label: 'China Culture Daily' },
                { value: 'china-environment-news', label: 'China Environment News' },
                { value: 'china-tourism-news', label: 'China Tourism News' },
                { value: 'china-transport-news', label: 'China Transport News' },
                { value: 'sina-news', label: 'Sina News' }
            ],
            
            // CHINA (English)
            'cn_en': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'china-daily', label: 'China Daily' },
                { value: 'cgtn-english', label: 'CGTN English' },
                { value: 'xinhua-english', label: 'Xinhua English' },
                { value: 'global-times', label: 'Global Times' },
                { value: 'shanghai-daily', label: 'Shanghai Daily' },
                { value: 'china-plus', label: 'China Plus' },
                { value: 'ecns', label: 'ECNS' },
                { value: 'chinadaily-com', label: 'ChinaDaily.com' },
                { value: 'peoples-daily-english', label: "People's Daily English" },
                { value: 'beijing-review', label: 'Beijing Review' }
            ],
            
            // INDIA (English)
            'in_en': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'times-of-india', label: 'Times of India' },
                { value: 'hindustan-times', label: 'Hindustan Times' },
                { value: 'the-hindu', label: 'The Hindu' },
                { value: 'indian-express', label: 'Indian Express' },
                { value: 'ndtv', label: 'NDTV' },
                { value: 'zee-news', label: 'Zee News' },
                { value: 'india-today', label: 'India Today' },
                { value: 'cnn-news18', label: 'CNN-News18' },
                { value: 'news18', label: 'News18' },
                { value: 'republic-tv', label: 'Republic TV' },
                { value: 'times-now', label: 'Times Now' },
                { value: 'aaj-tak-english', label: 'Aaj Tak English' },
                { value: 'business-standard', label: 'Business Standard' },
                { value: 'economic-times', label: 'Economic Times' },
                { value: 'mint', label: 'Mint' },
                { value: 'moneycontrol', label: 'Moneycontrol' },
                { value: 'deccan-herald', label: 'Deccan Herald' },
                { value: 'deccan-chronicle', label: 'Deccan Chronicle' },
                { value: 'telegraph-india', label: 'Telegraph India' },
                { value: 'firstpost', label: 'Firstpost' },
                { value: 'the-quint', label: 'The Quint' }
            ],
            
            // BRASIL (Portuguese)
            'br_pt': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'folha-de-sao-paulo', label: 'Folha de S.Paulo' },
                { value: 'o-globo', label: 'O Globo' },
                { value: 'estadao', label: 'Estad√£o' },
                { value: 'uol', label: 'UOL' },
                { value: 'g1', label: 'G1' },
                { value: 'band-news', label: 'Band News' },
                { value: 'sbt-news', label: 'SBT News' },
                { value: 'record-tv', label: 'Record TV' },
                { value: 'cnn-brasil', label: 'CNN Brasil' },
                { value: 'jovem-pan', label: 'Jovem Pan' },
                { value: 'veja', label: 'Veja' },
                { value: 'epoca', label: '√âpoca' },
                { value: 'isto√©', label: 'Isto√â' },
                { value: 'carta-capital', label: 'Carta Capital' },
                { value: 'brasil-247', label: 'Brasil 247' },
                { value: 'correio-braziliense', label: 'Correio Braziliense' },
                { value: 'zero-hora', label: 'Zero Hora' },
                { value: 'diario-de-pernambuco', label: 'Di√°rio de Pernambuco' },
                { value: 'o-dia', label: 'O Dia' },
                { value: 'lance', label: 'Lance!' },
                { value: 'globo-esporte', label: 'Globo Esporte' }
            ],
            
            // AUSTRALIA (English)
            'au_en': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'abc-news-au', label: 'ABC News Australia' },
                { value: 'sbs-news', label: 'SBS News' },
                { value: 'nine-news', label: 'Nine News' },
                { value: 'seven-news', label: 'Seven News' },
                { value: 'ten-news', label: 'Ten News' },
                { value: 'sky-news-australia', label: 'Sky News Australia' },
                { value: 'the-australian', label: 'The Australian' },
                { value: 'sydney-morning-herald', label: 'Sydney Morning Herald' },
                { value: 'the-age', label: 'The Age' },
                { value: 'herald-sun', label: 'Herald Sun' },
                { value: 'daily-telegraph-au', label: 'Daily Telegraph Australia' },
                { value: 'courier-mail', label: 'Courier Mail' },
                { value: 'west-australian', label: 'West Australian' },
                { value: 'advertiser', label: 'The Advertiser' },
                { value: 'canberra-times', label: 'Canberra Times' },
                { value: 'northern-territory-news', label: 'NT News' },
                { value: 'australian-financial-review', label: 'Australian Financial Review' },
                { value: 'news-com-au', label: 'News.com.au' },
                { value: 'crikey', label: 'Crikey' },
                { value: 'the-conversation-au', label: 'The Conversation Australia' },
                { value: 'guardian-australia', label: 'Guardian Australia' }
            ],
            
            // RUSIA (Russian)
            'ru_ru': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'rt-russia', label: 'RT (Russia Today)' },
                { value: 'sputnik', label: 'Sputnik' },
                { value: 'tass', label: 'TASS' },
                { value: 'ria-novosti', label: 'RIA Novosti' },
                { value: 'interfax', label: 'Interfax' },
                { value: 'rossiyskaya-gazeta', label: 'Rossiyskaya Gazeta' },
                { value: 'izvestia', label: 'Izvestia' },
                { value: 'kommersant', label: 'Kommersant' },
                { value: 'vedomosti', label: 'Vedomosti' },
                { value: 'novaya-gazeta', label: 'Novaya Gazeta' },
                { value: 'lenta-ru', label: 'Lenta.ru' },
                { value: 'gazeta-ru', label: 'Gazeta.ru' },
                { value: 'mk', label: 'Moskovskij Komsomolets' },
                { value: 'kp', label: 'Komsomolskaya Pravda' },
                { value: 'arguments-facts', label: 'Arguments and Facts' },
                { value: 'rbc', label: 'RBC' },
                { value: 'echo-moscow', label: 'Echo of Moscow' },
                { value: 'meduza', label: 'Meduza' },
                { value: 'dozhd', label: 'TV Rain' },
                { value: 'channel-one', label: 'Channel One Russia' },
                { value: 'ntv-ru', label: 'NTV Russia' }
            ],
            
            // M√âXICO (Spanish)
            'mx_es': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'televisa', label: 'Televisa' },
                { value: 'tv-azteca', label: 'TV Azteca' },
                { value: 'milenio', label: 'Milenio' },
                { value: 'reforma', label: 'Reforma' },
                { value: 'el-universal-mx', label: 'El Universal' },
                { value: 'excelsior', label: 'Exc√©lsior' },
                { value: 'la-jornada', label: 'La Jornada' },
                { value: 'proceso', label: 'Proceso' },
                { value: 'animal-politico', label: 'Animal Pol√≠tico' },
                { value: 'el-financiero', label: 'El Financiero' },
                { value: 'expansion', label: 'Expansi√≥n' },
                { value: 'forbes-mexico', label: 'Forbes M√©xico' },
                { value: 'cnn-mexico', label: 'CNN M√©xico' },
                { value: 'aristegui-noticias', label: 'Aristegui Noticias' },
                { value: 'sin-embargo', label: 'Sin Embargo' },
                { value: 'el-economista', label: 'El Economista' },
                { value: 'record-mx', label: 'R√©cord M√©xico' },
                { value: 'medio-tiempo', label: 'Medio Tiempo' },
                { value: 'once-tv', label: 'Once TV' },
                { value: 'canal-22', label: 'Canal 22' },
                { value: 'mvs-noticias', label: 'MVS Noticias' }
            ],
            
            // ARGENTINA (Spanish)
            'ar_es': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'clarin', label: 'Clar√≠n' },
                { value: 'la-nacion', label: 'La Naci√≥n' },
                { value: 'pagina-12', label: 'P√°gina/12' },
                { value: 'infobae', label: 'Infobae' },
                { value: 'ambito', label: '√Åmbito' },
                { value: 'perfil', label: 'Perfil' },
                { value: 'cronica', label: 'Cr√≥nica' },
                { value: 'ole', label: 'Ol√©' },
                { value: 'tyc-sports', label: 'TyC Sports' },
                { value: 'espn-argentina', label: 'ESPN Argentina' },
                { value: 'fox-sports-ar', label: 'Fox Sports Argentina' },
                { value: 'telefe', label: 'Telefe' },
                { value: 'canal-13-ar', label: 'Canal 13 Argentina' },
                { value: 'america-tv', label: 'Am√©rica TV' },
                { value: 'tn', label: 'TN - Todo Noticias' },
                { value: 'c5n', label: 'C5N' },
                { value: 'a24', label: 'A24' },
                { value: 'canal-26', label: 'Canal 26' },
                { value: 'cronista', label: 'El Cronista' },
                { value: 'minuto-uno', label: 'Minuto Uno' },
                { value: 'tiempo-argentino', label: 'Tiempo Argentino' }
            ],
            
            // SUIZA m√∫ltiples idiomas
            'ch_de': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'nzz', label: 'Neue Z√ºrcher Zeitung' },
                { value: 'tages-anzeiger', label: 'Tages-Anzeiger' },
                { value: 'blick', label: 'Blick' },
                { value: '20-minuten', label: '20 Minuten' },
                { value: 'watson-ch', label: 'Watson.ch' },
                { value: 'srf', label: 'SRF' },
                { value: 'swissinfo-de', label: 'SWI swissinfo.ch (DE)' },
                { value: 'basellandschaftliche', label: 'Basellandschaftliche Zeitung' },
                { value: 'aargauer-zeitung', label: 'Aargauer Zeitung' },
                { value: 'st-galler-tagblatt', label: 'St. Galler Tagblatt' }
            ],
            'ch_fr': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'le-temps', label: 'Le Temps' },
                { value: 'tribune-de-geneve', label: 'Tribune de Gen√®ve' },
                { value: '24-heures', label: '24 heures' },
                { value: 'le-matin', label: 'Le Matin' },
                { value: 'rts', label: 'RTS' },
                { value: 'swissinfo-fr', label: 'SWI swissinfo.ch (FR)' },
                { value: 'la-liberte', label: 'La Libert√©' },
                { value: 'arc-info', label: 'arcinfo' },
                { value: 'journal-du-jura', label: 'Journal du Jura' },
                { value: 'le-nouvelliste-ch', label: 'Le Nouvelliste' }
            ],
            'ch_it': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'corriere-del-ticino', label: 'Corriere del Ticino' },
                { value: 'la-regione', label: 'La Regione' },
                { value: 'giornale-del-popolo', label: 'Giornale del Popolo' },
                { value: 'rsi', label: 'RSI' },
                { value: 'swissinfo-it', label: 'SWI swissinfo.ch (IT)' },
                { value: 'tio', label: 'Tio.ch' },
                { value: 'lanostratv', label: 'LaNostraTV' }
            ],
            
            // HOLANDA (Dutch)
            'nl_nl': [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'nos', label: 'NOS' },
                { value: 'rtl-nieuws', label: 'RTL Nieuws' },
                { value: 'telegraaf', label: 'De Telegraaf' },
                { value: 'volkskrant', label: 'de Volkskrant' },
                { value: 'ad', label: 'Algemeen Dagblad' },
                { value: 'nrc', label: 'NRC' },
                { value: 'trouw', label: 'Trouw' },
                { value: 'parool', label: 'Het Parool' },
                { value: 'financieele-dagblad', label: 'Het Financieele Dagblad' },
                { value: 'nu-nl', label: 'NU.nl' },
                { value: 'bnn-vara', label: 'BNNVara' },
                { value: 'veronica', label: 'Veronica' },
                { value: 'sbs6', label: 'SBS6' },
                { value: 'rtl4', label: 'RTL4' },
                { value: 'eo', label: 'EO' },
                { value: 'omroep-west', label: 'Omroep West' },
                { value: 'omroep-brabant', label: 'Omroep Brabant' },
                { value: 'rtvnh', label: 'NH Nieuws' },
                { value: 'tubantia', label: 'Tubantia' },
                { value: 'bnr', label: 'BNR Nieuwsradio' },
                { value: 'radio1', label: 'NPO Radio 1' }
            ],
            
            // Global/International sources
            global: [
                { value: 'any', label: 'üåü Any reliable source' },
                { value: 'bbc-news', label: 'BBC News' },
                { value: 'cnn-international', label: 'CNN International' },
                { value: 'reuters', label: 'Reuters' },
                { value: 'associated-press', label: 'Associated Press' },
                { value: 'al-jazeera-english', label: 'Al Jazeera English' },
                { value: 'france24-english', label: 'France 24 English' },
                { value: 'deutsche-welle-english', label: 'Deutsche Welle English' },
                { value: 'euronews', label: 'Euronews' },
                { value: 'bloomberg', label: 'Bloomberg' },
                { value: 'financial-times', label: 'Financial Times' },
                { value: 'the-economist', label: 'The Economist' },
                { value: 'time-international', label: 'Time International' },
                { value: 'newsweek-international', label: 'Newsweek International' },
                { value: 'guardian-international', label: 'The Guardian International' },
                { value: 'independent-international', label: 'The Independent International' }
            ]
        };

        document.getElementById('country_interest').addEventListener('change', function() {
            const country = this.value;
            const languageGroup = document.getElementById('language-group');
            const languageSelect = document.getElementById('language_interest');
            const sourcesGroup = document.getElementById('sources-group');
            const sourcesCheckboxes = document.getElementById('sources-checkboxes');
            sourcesCheckboxes.innerHTML = '';
            languageSelect.innerHTML = '';
            // Si el pa√≠s tiene varios idiomas, mostrar el selector de idioma
            if (countryLanguages[country] && countryLanguages[country].length > 1) {
                languageGroup.style.display = 'block';
                countryLanguages[country].forEach(lang => {
                    const option = document.createElement('option');
                    option.value = lang;
                    option.textContent = languageNames[lang] || lang;
                    languageSelect.appendChild(option);
                });
                // Disparar el evento para mostrar las fuentes del primer idioma por defecto
                languageSelect.dispatchEvent(new Event('change'));
            } else if (countryLanguages[country] && countryLanguages[country].length === 1) {
                languageGroup.style.display = 'none';
                const lang = countryLanguages[country][0];
                showSources(country, lang);
            } else {
                languageGroup.style.display = 'none';
                showSources(country, null);
            }
        });

        document.getElementById('language_interest').addEventListener('change', function() {
            const country = document.getElementById('country_interest').value;
            const lang = this.value;
            showSources(country, lang);
        });

        function showSources(country, lang) {
            const sourcesGroup = document.getElementById('sources-group');
            const sourcesCheckboxes = document.getElementById('sources-checkboxes');
            sourcesCheckboxes.innerHTML = '';
            let sources = [];
            
            // Determine which sources to show based on country and language
            const key = lang ? `${country}_${lang}` : country;
            if (sourcesByCountryLang[key]) {
                sources = sourcesByCountryLang[key];
            } else if (sourcesByCountryLang[country]) {
                sources = sourcesByCountryLang[country];
            } else {
                sources = sourcesByCountryLang['global'];
            }
            
            if (sources && sources.length > 0) {
                sources.forEach(source => {
                    const label = document.createElement('label');
                    label.className = 'checkbox-item';
                    
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.name = 'sources';
                    checkbox.value = source.value;
                    checkbox.addEventListener('change', updateSelectedSources);
                    
                    const span = document.createElement('span');
                    span.textContent = source.label;
                    
                    label.appendChild(checkbox);
                    label.appendChild(span);
                    sourcesCheckboxes.appendChild(label);
                });
                sourcesGroup.style.display = 'block';
            } else {
                sourcesGroup.style.display = 'none';
            }
        }

        function updateSelectedSources() {
            const selectedSources = document.querySelectorAll('input[name="sources"]:checked');
            const selectedSourcesContainer = document.getElementById('selected-sources');
            const selectedSourcesList = document.getElementById('selected-sources-list');
            
            // Clear existing selected sources
            selectedSourcesList.innerHTML = '';
            
            if (selectedSources.length > 0) {
                selectedSources.forEach(checkbox => {
                    const sourceLabel = checkbox.parentElement.querySelector('span').textContent;
                    
                    const tag = document.createElement('div');
                    tag.className = 'selected-source-tag';
                    
                    const labelSpan = document.createElement('span');
                    labelSpan.textContent = sourceLabel;
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'remove-source';
                    removeBtn.innerHTML = '√ó';
                    removeBtn.type = 'button';
                    removeBtn.addEventListener('click', () => {
                        checkbox.checked = false;
                        updateSelectedSources();
                    });
                    
                    tag.appendChild(labelSpan);
                    tag.appendChild(removeBtn);
                    selectedSourcesList.appendChild(tag);
                });
                selectedSourcesContainer.classList.add('show');
            } else {
                selectedSourcesContainer.classList.remove('show');
            }
        }

        // Form submission
        document.getElementById('preferencesForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const loading = document.getElementById('loading');
            const form = document.getElementById('preferencesForm');
            const successMessage = document.getElementById('successMessage');
            
            // Validate that at least one interest is selected
            const interests = document.querySelectorAll('input[name="interests"]:checked');
            if (interests.length === 0) {
                alert('Please select at least one topic of interest.');
                return;
            }
            
            // Show loading
            submitBtn.disabled = true;
            form.style.display = 'none';
            loading.style.display = 'block';
            
            // Generate unique client ID for personalization
            const clientId = generateClientId();
            
            // Collect form data
            const formData = new FormData(form);
            const selectedCountries = Array.from(document.querySelectorAll('input[name="countries"]:checked')).map(cb => cb.value);
            const selectedSources = Array.from(document.querySelectorAll('input[name="sources"]:checked')).map(cb => cb.value);
            const selectedInterests = Array.from(interests).map(cb => cb.value);
            
            // Process country and timezone data
            const countryTimezone = formData.get('country_timezone');
            const [countryName, timezone] = countryTimezone ? countryTimezone.split('|') : ['', ''];
            const countryCode = extractCountryCode(countryName);
            
            // Map sources to NewsAPI format
            const newsApiSources = mapToNewsApiSources(selectedSources, selectedCountries);
            
            // Prepare personalized data structure for n8n/NewsAPI
            const personalizedData = {
                // Client identification
                clientId: clientId,
                email: formData.get('email'),
                name: formData.get('name'),
                telegram: formData.get('telegram') || '',
                
                // News preferences for NewsAPI
                newsPreferences: {
                    topics: selectedInterests, // For NewsAPI category parameter
                    countries: selectedCountries.map(country => extractCountryCode(country)), // ISO country codes
                    sources: newsApiSources.validSources, // NewsAPI source IDs
                    language: detectLanguage(selectedCountries[0]), // Primary language for NewsAPI
                    frequency: formData.get('frequency'),
                },
                
                // Geographical data
                location: {
                    primaryCountry: countryCode,
                    timezone: timezone,
                    selectedCountries: selectedCountries
                },
                
                // Additional client data
                metadata: {
                    timestamp: new Date().toISOString(),
                    source: 'simply-news-survey',
                    version: '2.0',
                    invalidSources: newsApiSources.invalidSources, // For debugging
                    totalSourcesSelected: selectedSources.length,
                    browserLanguage: navigator.language,
                    userAgent: navigator.userAgent.substring(0, 100) // Truncated for privacy
                },
                
                // Comments
                comments: formData.get('comments') || '',
                
                // For n8n workflow routing
                workflowConfig: {
                    enablePersonalization: true,
                    createSchedule: true,
                    setupTelegramBot: formData.get('telegram') ? true : false,
                    clientType: 'survey_subscriber'
                }
            };
            
            try {
                // Primary webhook for client data and workflow setup
                const webhookUrl = 'https://your-n8n-instance.com/webhook/simply-news-client-setup';
                
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Client-ID': clientId,
                        'X-Source': 'simply-news-survey'
                    },
                    body: JSON.stringify(personalizedData)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    
                    // Show success message
                    loading.style.display = 'none';
                    successMessage.style.display = 'block';
                    
                    // Store client ID in localStorage for future reference
                    localStorage.setItem('simply_news_client_id', clientId);
                    localStorage.setItem('simply_news_setup_date', new Date().toISOString());
                    
                    // Optional: send to Google Analytics
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'survey_submitted', {
                            'event_category': 'engagement',
                            'event_label': 'preferences_survey',
                            'custom_parameters': {
                                'client_id': clientId,
                                'sources_count': selectedSources.length,
                                'countries_count': selectedCountries.length,
                                'interests_count': selectedInterests.length
                            }
                        });
                    }
                    
                    // Optional: Test NewsAPI connection (for debugging)
                    if (result.testMode === true) {
                        testNewsApiConnection(personalizedData.newsPreferences);
                    }
                    
                } else {
                    throw new Error(`Server error: ${response.status}`);
                }
                
            } catch (error) {
                console.error('Error:', error);
                alert('There was an error sending your preferences. Please try again.');
                
                // Restore form
                loading.style.display = 'none';
                form.style.display = 'block';
                submitBtn.disabled = false;
            }
        });
        
        // Helper functions for NewsAPI integration
        function generateClientId() {
            const timestamp = Date.now();
            const random = Math.random().toString(36).substr(2, 9);
            return `sn_${timestamp}_${random}`;
        }
        
        function extractCountryCode(countryString) {
            if (!countryString) return '';
            // Extract country code from format "üá∫üá∏ United States"
            const match = countryString.match(/üá∫üá∏|üá¨üáß|üá®üá¶|üá´üá∑|üá©üá™|üá™üá∏|üáÆüáπ|üáØüáµ|üá®üá≥|üáÆüá≥|üáßüá∑|üá¶üá∫|üá∑üá∫|üá≤üáΩ|üá¶üá∑|üá®üá≠|üá≥üá±/);
            
            const flagToCode = {
                'üá∫üá∏': 'us', 'üá¨üáß': 'gb', 'üá®üá¶': 'ca', 'üá´üá∑': 'fr', 'üá©üá™': 'de',
                'üá™üá∏': 'es', 'üáÆüáπ': 'it', 'üáØüáµ': 'jp', 'üá®üá≥': 'cn', 'üáÆüá≥': 'in',
                'üáßüá∑': 'br', 'üá¶üá∫': 'au', 'üá∑üá∫': 'ru', 'üá≤üáΩ': 'mx', 'üá¶üá∑': 'ar',
                'üá®üá≠': 'ch', 'üá≥üá±': 'nl'
            };
            
            return match ? flagToCode[match[0]] : '';
        }
        
        function detectLanguage(countryString) {
            const countryCode = extractCountryCode(countryString);
            const countryToLanguage = {
                'us': 'en', 'gb': 'en', 'ca': 'en', 'au': 'en',
                'fr': 'fr', 'de': 'de', 'es': 'es', 'it': 'it',
                'jp': 'ja', 'cn': 'zh', 'in': 'en', 'br': 'pt',
                'ru': 'ru', 'mx': 'es', 'ar': 'es', 'ch': 'de', 'nl': 'nl'
            };
            
            return countryToLanguage[countryCode] || 'en';
        }
        
        function mapToNewsApiSources(selectedSources, selectedCountries) {
            // Map our internal source IDs to actual NewsAPI source IDs
            const newsApiSourceMap = {
                // US Sources
                'cnn': 'cnn',
                'fox-news': 'fox-news',
                'nbc-news': 'nbc-news',
                'abc-news': 'abc-news',
                'cbs-news': 'cbs-news',
                'the-new-york-times': 'the-new-york-times',
                'the-washington-post': 'the-washington-post',
                'the-wall-street-journal': 'the-wall-street-journal',
                'usa-today': 'usa-today',
                'reuters': 'reuters',
                'associated-press': 'associated-press',
                'bloomberg': 'bloomberg',
                'politico': 'politico',
                'the-hill': 'the-hill',
                'time': 'time',
                'newsweek': 'newsweek',
                
                // UK Sources
                'bbc-news': 'bbc-news',
                'the-guardian-uk': 'the-guardian-uk',
                'independent': 'independent',
                'daily-mail': 'daily-mail',
                'financial-times': 'financial-times',
                'the-economist': 'the-economist',
                
                // Other major international sources
                'al-jazeera-english': 'al-jazeera-english',
                'france24': 'france24',
                'deutsche-welle': 'deutsche-welle',
                
                // Add more mappings as needed...
                // Note: Many sources might not be in NewsAPI, we'll handle this
            };
            
            const validSources = [];
            const invalidSources = [];
            
            selectedSources.forEach(source => {
                if (source === 'any') {
                    // 'any' means use NewsAPI without source restriction
                    return;
                }
                
                if (newsApiSourceMap[source]) {
                    validSources.push(newsApiSourceMap[source]);
                } else {
                    invalidSources.push(source);
                }
            });
            
            return {
                validSources: validSources,
                invalidSources: invalidSources,
                useAnySource: selectedSources.includes('any')
            };
        }
        
        // Optional: Test NewsAPI connection (for development/debugging)
        async function testNewsApiConnection(newsPreferences) {
            try {
                const testUrl = '/api/test-newsapi'; // Your backend endpoint
                const testData = {
                    sources: newsPreferences.sources.slice(0, 5), // Test with first 5 sources
                    topics: newsPreferences.topics.slice(0, 2), // Test with first 2 topics
                    countries: newsPreferences.countries.slice(0, 1), // Test with first country
                    language: newsPreferences.language
                };
                
                const response = await fetch(testUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(testData)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    console.log('NewsAPI test successful:', result);
                } else {
                    console.warn('NewsAPI test failed:', response.status);
                }
            } catch (error) {
                console.warn('NewsAPI test error:', error);
            }
        }
    </script>
</body>
</html> 